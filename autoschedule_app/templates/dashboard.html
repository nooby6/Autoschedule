<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="/static/dashstyles.css">
    <script src="/autoschedule_app/app.js" defer></script>
</head>
<body>
    <!-- Header with navigation links -->
    <header>
        <nav>
            <ul>
                <li><a href="dashboard.html">Dashboard</a></li>
                <li><a href="#" id="logout-btn">Logout</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <!-- Dashboard Section -->
        <section id="dashboard" class="dashboard-page">
            <div class="sidebar">
                <h2>Navigation</h2>
                <a href="#schedule" onclick="showSection('schedule')">View Schedule</a>
                <a href="#profile" onclick="showSection('profile')">User Profile</a>
                <a href="#admin" onclick="showAdminSection()">Admin</a>
            </div>
            <div class="main-content">
                <h2>Dashboard</h2>
                <div class="overview card">
                    <p>Welcome, <span id="user-name">User</span></p>
                    <p>Next shift: <span id="next-shift">None</span></p>
                </div>
                <div class="calendar card">
                    <div id="calendar"></div>
                </div>
                <div class="actions">
                    <button onclick="showSection('schedule')" class="button">Manage Schedule</button>
                    <button onclick="showSection('profile')" class="button">Edit Profile</button>
                </div>
            </div>
        </section>

        <!-- Schedule Management Section -->
        <section id="schedule" class="schedule-page">
            <div class="container">
                <h2>Manage Schedule</h2>
                <div class="schedule-list">
                    <!-- Schedule items will be populated here -->
                </div>
                <button onclick="showSection('add-shift')">Add Shift</button>
                <button onclick="showSection('dashboard')">Back to Dashboard</button>
            </div>
        </section>

        <!-- Add Shift Section -->
        <section id="add-shift" class="add-shift-page">
            <div class="container">
                <h2>Add New Shift</h2>
                <form id="add-shift-form">
                    <label for="shift-date">Date</label>
                    <input type="date" id="shift-date" name="shift-date" required>
                    
                    <label for="shift-time">Time</label>
                    <input type="time" id="shift-time" name="shift-time" required>
                    
                    <label for="shift-unit">Unit</label>
                    <input type="text" id="shift-unit" name="shift-unit" required>
                    
                    <button type="submit">Add Shift</button>
                </form>
                <button onclick="showSection('schedule')">Back to Schedule</button>
            </div>
        </section>

        <!-- User Profile Section -->
        <section id="profile" class="profile-page">
            <div class="profile-container">
                <h2>User Profile</h2>
                <div class="profile-image">
                    <img src="/static/assets/profile-image.jpg" alt="Profile Image">
                </div>
                <div class="profile-details">
                    <div class="profile-item"><label for="name">Name:</label><span id="name">John Doe</span></div>
                    <div class="profile-item"><label for="phone">Phone Number:</label><span id="phone">(123) 456-7890</span></div>
                    <div class="profile-item"><label for="age">Age:</label><span id="age">30</span></div>
                    <div class="profile-item"><label for="position">Position:</label><span id="position">Software Engineer</span></div>
                    <div class="profile-item"><label for="department">Department:</label><span id="department">Oncology</span></div>
                    <div class="profile-item"><label for="email">Email:</label><span id="email">john.doe@example.com</span></div>
                    <div class="profile-item"><label for="address">Address:</label><span id="address">123 Main St, Anytown, USA</span></div>
                </div>
            </div>
        </section>

        <!-- Admin Section -->
        <section id="admin" class="admin-page">
            <div class="admin-container">
                <h2>Admin Dashboard</h2>
                <table id="user-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Is Admin</th>
                            <th>Shift Details</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- User rows will be inserted here -->
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Function to show the selected section and hide others
            const showSection = (sectionId) => {
                document.querySelectorAll('section').forEach(section => {
                    section.style.display = section.id === sectionId ? 'block' : 'none';
                });
            }

            // Function to render users in admin section
            const renderUsers = () => {
                const userTableBody = document.getElementById("user-table").querySelector("tbody");
                userTableBody.innerHTML = ""; // Clear existing rows

                users.forEach(user => {
                    const row = document.createElement("tr");
                    row.innerHTML = `
                        <td>${user.name}</td>
                        <td>${user.email}</td>
                        <td>${user.isAdmin ? "Yes" : "No"}</td>
                        <td>${getShiftDetails(user)}</td>
                    `;
                    userTableBody.appendChild(row);
                });
            }

            // Function to simulate or retrieve shift details for a user
            const getShiftDetails = (user) => {
                return `Shift details for ${user.name}`; // Replace with actual shift data
            }

            // Show the admin section
            const showAdminSection = () => {
                showSection('admin');
                renderUsers();
            }

            // Event listener for logout button
            document.getElementById('logout-btn').addEventListener('click', () => {
                logout(); // Call logout function on button click
            });

            // Function to handle logout action
            function logout() {
                localStorage.removeItem("loggedInUser"); // Clear user data
                 console.log("Logging out... Redirecting to index.html"); // Debugging line
                 window.location.href = "index.html"; // Redirect to landing page
}


            // Show the dashboard section by default
            showSection('dashboard');
        });
    </script>
</body>
</html>
